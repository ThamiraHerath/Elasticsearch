---
stored _source mode is supported:
  - requires:
      cluster_features: ["mapper.source.remove_synthetic_source_only_validation"]
      reason: requires new validation logic

  - do:
      indices.create:
        index: test-stored-source
        body:
          settings:
            index:
              mode: logsdb
          mappings:
            _source:
              mode: stored
  - do:
      indices.get:
        index: test-stored-source

  - match: { test-stored-source.mappings._source.mode: "stored" }

---
disabled _source is supported:
  - requires:
      cluster_features: ["mapper.source.remove_synthetic_source_only_validation"]
      reason: requires new validation logic

  - do:
      indices.create:
        index: test-disabled-source
        body:
          settings:
            index:
              mode: logsdb
          mappings:
            _source:
              enabled: false

  - do:
      indices.get:
        index: test-disabled-source

  - match: { test-disabled-source.mappings._source.enabled: false }

  - do:
      indices.create:
        index: test-disabled-mode-source
        body:
          settings:
            index:
              mode: logsdb
          mappings:
            _source:
              mode: disabled

  - do:
      indices.get:
        index: test-disabled-mode-source

  - match: { test-disabled-mode-source.mappings._source.mode: "disabled" }
